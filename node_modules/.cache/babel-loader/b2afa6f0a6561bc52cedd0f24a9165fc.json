{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\TG\\\\Desktop\\\\mandatory-advanced-js5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\TG\\\\Desktop\\\\mandatory-advanced-js5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\TG\\\\Desktop\\\\mandatory-advanced-js5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\TG\\\\Desktop\\\\mandatory-advanced-js5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _inherits from\"C:\\\\Users\\\\TG\\\\Desktop\\\\mandatory-advanced-js5\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Dropbox}from\"dropbox\";import LogOut from'./LogOut';import LeftNav from\"./LeftNav\";import Folders from\"./Folders\";import RightNav from\"./RightNav\";import Header from'./Header';import{Redirect}from'react-router-dom';import'../Css/icons.css';import'../Css/mainFiles.css';import'../Css/nav.css';import'../Css/UlItems.css';var Main=/*#__PURE__*/function(_Component){_inherits(Main,_Component);function Main(props){var _this;_classCallCheck(this,Main);_this=_possibleConstructorReturn(this,_getPrototypeOf(Main).call(this,props));_this.setFolderState=function(newFolder){_this.setState({folder:newFolder});};_this.setFileState=function(newFile){_this.setState({file:newFile});};_this.copy=function(original_path,your_path){var real_path=original_path.split('/');real_path=\"/\".concat(real_path[real_path.length-1]);_this.dbx.filesCopy({from_path:original_path,to_path:\"\".concat(your_path).concat(real_path),autorename:true});};_this.search_FOLDERS_FILES=function(e){var resFolder;console.log(\"TESTA\",e.target.value);_this.setState({searchQuery:e.target.value});if(e.target.value.length===0){return;}_this.dbx.filesSearch({path:'',query:e.target.value}).then(function(res){console.log(res);resFolder=res;var entries=res.matches.map(function(x){return x.metadata;});_this.setState({folders:entries});entries=entries.filter(function(x){return x[\".tag\"]===\"file\";}).map(function(x){return{path:x.path_display};});return _this.dbx.filesGetThumbnailBatch({entries:entries});}).then(function(res){var files=resFolder.matches.filter(function(x){return x.metadata[\".tag\"]!==\"folder\";}).map(function(x){var th=res.entries.find(function(y){return y.metadata&&y.metadata.id===x.metadata.id;});return{metadata:x.metadata,\".tag\":\"success\",thumbnail:th?th.thumbnail:null};});console.log(files);_this.setState({files:files});});};_this.state={folders:[],files:[],changes:false,starArray:[],searchQuery:\"\"};_this.renameRef=React.createRef();return _this;}_createClass(Main,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.setState({starArray:JSON.parse(window.localStorage.getItem(\"favorites\")||\"[]\")});var log=JSON.parse(window.localStorage.getItem(\"favorites\"));this.dbx=new Dropbox({accessToken:localStorage.getItem(\"token\")});var path=\"\";if(this.props.match.params.path){path=\"/\".concat(this.props.match.params.path);}this.dbx.filesListFolder({path:path}).then(function(resFolder){console.log(resFolder);_this2.dbx.filesListFolderLongpoll({cursor:resFolder.cursor}).then(function(response){console.log('lol');_this2.setState({changes:response.changes});});var entries=resFolder.entries.filter(function(x){return x[\".tag\"]===\"file\";}).map(function(x){return{path:x.path_display};});return _this2.dbx.filesGetThumbnailBatch({entries:entries}).then(function(res){var files=resFolder.entries.filter(function(x){return x[\".tag\"]!==\"folder\";}).map(function(x){var th=res.entries.find(function(y){return y.metadata&&y.metadata.id===x.id;});return{metadata:x,\".tag\":\"success\",thumbnail:th?th.thumbnail:null};});_this2.setState({files:files,folders:resFolder.entries});});});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState){var _this3=this;if(this.state.changes||this.props.match.params.path!==prevProps.match.params.path||this.state.searchQuery===\"\"&&prevState.searchQuery!==this.state.searchQuery){console.log('lol');var path=\"\";if(this.props.match.params.path){path=\"/\".concat(this.props.match.params.path);}this.dbx.filesListFolder({path:path}).then(function(resFolder){_this3.dbx.filesListFolderLongpoll({cursor:resFolder.cursor}).then(function(response){return _this3.setState({changes:response.changes});});var entries=resFolder.entries.filter(function(x){return x[\".tag\"]===\"file\";}).map(function(x){return{path:x.path_display};});return _this3.dbx.filesGetThumbnailBatch({entries:entries}).then(function(res){var files=resFolder.entries.filter(function(x){return x[\".tag\"]!==\"folder\";}).map(function(x){var th=res.entries.find(function(y){return y.metadata&&y.metadata.id===x.id;});return{metadata:x,\".tag\":\"success\",thumbnail:th?th.thumbnail:null};});_this3.setState({files:files,folders:resFolder.entries,changes:false});});});}}},{key:\"render\",value:function render(){var _this$state=this.state,folders=_this$state.folders,files=_this$state.files;return React.createElement(\"div\",{className:\"App\"},React.createElement(LeftNav,{dbx:this.dbx}),React.createElement(\"div\",{className:\"bigBox\"},React.createElement(Header,{search_FOLDERS_FILES:this.search_FOLDERS_FILES,path:this.props.match.params.path}),React.createElement(\"main\",null,React.createElement(Folders,{dbx:this.dbx,files:files,renameFiles:this.renameFiles,updateFileName:this.updateFileName,copy:this.copy,renameFolders:this.renameFolders,updateFolderName:this.updateFolderName,folders:folders,onDelete:this.onDelete,setFileState:this.setFileState,setFolderState:this.setFolderState}),React.createElement(RightNav,{path:this.props.match.params.path,files:files,folders:folders,dbx:this.dbx,setFileState:this.setFileState,setFolderState:this.setFolderState}))));}}]);return Main;}(Component);export default Main;","map":{"version":3,"sources":["C:/Users/TG/Desktop/mandatory-advanced-js5/src/Components/Main.js"],"names":["React","Component","Dropbox","LogOut","LeftNav","Folders","RightNav","Header","Redirect","Main","props","setFolderState","newFolder","setState","folder","setFileState","newFile","file","copy","original_path","your_path","real_path","split","length","dbx","filesCopy","from_path","to_path","autorename","search_FOLDERS_FILES","e","resFolder","console","log","target","value","searchQuery","filesSearch","path","query","then","res","entries","matches","map","x","metadata","folders","filter","path_display","filesGetThumbnailBatch","files","th","find","y","id","thumbnail","state","changes","starArray","renameRef","createRef","JSON","parse","window","localStorage","getItem","accessToken","match","params","filesListFolder","filesListFolderLongpoll","cursor","response","prevProps","prevState","renameFiles","updateFileName","renameFolders","updateFolderName","onDelete"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { Dropbox } from \"dropbox\";\nimport LogOut from './LogOut'\nimport LeftNav from \"./LeftNav\"\nimport Folders from \"./Folders\"\nimport RightNav from \"./RightNav\"\nimport Header from './Header'\nimport {Redirect} from 'react-router-dom'\n\nimport '../Css/icons.css'\nimport '../Css/mainFiles.css'\nimport '../Css/nav.css'\nimport '../Css/UlItems.css'\n\nclass Main extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n          folders: [],\n          files: [],\n\n          changes: false,\n\n          starArray: [],\n\n          searchQuery: \"\",\n\n        }\n        this.renameRef = React.createRef();\n    }\n    setFolderState = (newFolder) =>{\n      this.setState({folder: newFolder})\n    }\n    setFileState = (newFile) =>{\n      this.setState({file: newFile})\n    }\n\n\n\n    copy = (original_path, your_path) =>{\n      let real_path = original_path.split('/')\n      real_path = `/${real_path[real_path.length-1]}`\n      this.dbx.filesCopy({\n        from_path: original_path,\n        to_path: `${your_path}${real_path}`,\n        autorename: true,\n      })\n    }\n\n    componentDidMount() {\n      this.setState({\n        starArray: JSON.parse(window.localStorage.getItem(\"favorites\") || \"[]\")\n      });\n        let log = JSON.parse(window.localStorage.getItem(\"favorites\"));\n\n      this.dbx = new Dropbox({ accessToken: localStorage.getItem(\"token\") });\n      let path = \"\"\n\n      if(this.props.match.params.path){\n        path = `/${this.props.match.params.path}`\n      }\n      this.dbx.filesListFolder({ path: path })\n      .then((resFolder) => {\n        console.log(resFolder)\n        this.dbx.filesListFolderLongpoll({cursor: resFolder.cursor})\n        .then(response => {\n          console.log('lol')\n          this.setState({changes: response.changes})\n\n        })\n\n        const entries = resFolder.entries\n          .filter(x => x[\".tag\"] === \"file\")\n          .map((x) => ({ path: x.path_display }));\n        return this.dbx.filesGetThumbnailBatch({\n          entries: entries,\n        })\n        .then((res) => {\n          const files = resFolder.entries\n            .filter(x => x[\".tag\"] !== \"folder\")\n            .map(x => {\n              const th = res.entries.find(y => y.metadata && y.metadata.id === x.id);\n\n              return {\n                metadata: x,\n                \".tag\": \"success\",\n                thumbnail: th ? th.thumbnail : null,\n              }\n            });\n\n          this.setState({ files: files, folders: resFolder.entries});\n        })\n      })\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n      if (this.state.changes || this.props.match.params.path !== prevProps.match.params.path || (this.state.searchQuery === \"\" && (prevState.searchQuery !== this.state.searchQuery))) {\n        console.log('lol')\n\n        let path = \"\"\n        if(this.props.match.params.path){\n          path = `/${this.props.match.params.path}`\n        }\n        this.dbx.filesListFolder({ path: path })\n        .then((resFolder) => {\n\n          this.dbx.filesListFolderLongpoll({cursor: resFolder.cursor})\n          .then(response => this.setState({changes: response.changes}))\n\n          const entries = resFolder.entries\n            .filter(x => x[\".tag\"] === \"file\")\n            .map((x) => ({ path: x.path_display }));\n          return this.dbx.filesGetThumbnailBatch({\n            entries: entries,\n          })\n          .then((res) => {\n            const files = resFolder.entries\n            .filter(x => x[\".tag\"] !== \"folder\")\n            .map(x => {\n              const th = res.entries.find(y => y.metadata && y.metadata.id === x.id);\n\n              return {\n                metadata: x,\n                \".tag\": \"success\",\n                thumbnail: th ? th.thumbnail : null,\n              }\n            });\n            this.setState({ files: files, folders: resFolder.entries, changes:false });\n          })\n        })\n  }\n\n  }\n\n  search_FOLDERS_FILES = (e) => {\n\n    let resFolder;\n    console.log(\"TESTA\", e.target.value);\n\n    this.setState({ searchQuery: e.target.value });\n\n    if (e.target.value.length === 0) {\n      return;\n    }\n\n    this.dbx.filesSearch({ path: '' , query: e.target.value})\n    .then(res => {\n      console.log(res)\n      resFolder = res;\n      let entries = res.matches.map(x => x.metadata);\n\n      this.setState({ folders: entries });\n      entries = entries\n        .filter(x => x[\".tag\"] === \"file\")\n        .map((x) => ({ path: x.path_display }));\n      return this.dbx.filesGetThumbnailBatch({\n        entries: entries,\n      });\n      })\n      .then((res) => {\n\n        const files = resFolder.matches\n        .filter(x => x.metadata[\".tag\"] !== \"folder\")\n        .map(x => {\n          const th = res.entries.find(y => y.metadata && y.metadata.id === x.metadata.id);\n\n          return {\n            metadata: x.metadata,\n            \".tag\": \"success\",\n            thumbnail: th ? th.thumbnail : null,\n          }\n        });\n        console.log(files);\n        this.setState({ files: files });\n      });\n  }\n\n\n\n    render() {\n\n\n      const { folders, files } = this.state;\n\n        return (\n          <div className=\"App\" >\n\n          <LeftNav dbx={this.dbx}/>\n        <div className={\"bigBox\"}>\n          <Header search_FOLDERS_FILES={this.search_FOLDERS_FILES} path={this.props.match.params.path}/>\n          <main>\n            <Folders dbx={this.dbx} files={files} renameFiles={this.renameFiles} updateFileName={this.updateFileName} copy={this.copy}\n            renameFolders={this.renameFolders} updateFolderName={this.updateFolderName} folders={folders} onDelete={this.onDelete}  setFileState={this.setFileState} setFolderState={this.setFolderState}/>\n            <RightNav path={this.props.match.params.path} files={files} folders={folders} dbx={this.dbx} setFileState={this.setFileState} setFolderState={this.setFolderState} />\n          </main>\n        </div>\n    </div>\n      )\n    }\n  }\n\nexport default Main\n"]},"metadata":{},"sourceType":"module"}